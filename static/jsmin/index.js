(()=>{const e={fields_empty_or_session_error:"Check Your Username and Password or try to reload the page",no_such_user:"No Such User Exists",incorrect_password:"incorrect password"},n={fields_empty_or_session_error:"Check Your Username and Password or try to reload the page",bad_request:"Bad Username or Password",username_taken:"Username Already Taken"},s=e=>document.getElementById(e),r=s("errors-and-notices");String.prototype.isValid=function(){if(this.length>0)return/^[0-9a-zA-Z_.-]+$/.test(this)};const o=e=>`${Object.keys(e).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(e[n])}`).join("&")}`,t=document.querySelector('meta[name="integrity"]').content,a=s("errors"),i=s("login-btn"),l=s("register-btn");l.addEventListener("click",async()=>{const e=s("password-reg").value,a=s("password-reg-conf").value;if(e!==a)return r.innerHTML="Passwords Do Not Match!";{r.innerHTML="Loading";const i=await fetch("/register/check/",{credentials:"include",headers:{"content-type":"application/x-www-form-urlencoded"},method:"post",body:o({user:s("username-reg").value,password:e,checkpw:a,integrity:t})});try{const e=await i.json();if(403===i.status){const s=n[e.error];r.innerHTML=s}else 200!==i.status?r.innerHTML="An Error Occured..please reload the page and try again":r.innerHTML="Account Created. Please Login"}catch(e){return console.log(e),r.innerHTML="An Error Occured..please reload the page and try again"}}}),i.addEventListener("click",async()=>{r.innerHTML="Loading";const n=await fetch("/login/check/",{credentials:"include",method:"post",headers:{"content-type":"application/x-www-form-urlencoded"},body:o({user:s("username-log").value,password:s("password-log").value,integrity:t})});try{const s=await n.json();if(403===n.status){const n=e[s.error];r.innerHTML=n}else 200!==n.status?r.innerHTML="An Error Occured..please reload the page and try again":window.location.replace(`/u/${s.user}`)}catch(e){return console.log(e),r.innerHTML="An Error Occured..please reload the page and try again"}}),s("password-log").addEventListener("keydown",e=>{const n=s("password-log"),r=s("username-log");0!==n.value.length&&0!==r.value.length&&13===e.keyCode&&i.click()});const d=s("username-reg"),c=s("password-reg"),u=s("password-reg-conf");check_passwords=(e=>{e.value!==c.value?(a.style.visibility="visible",a.innerHTML="Passwords Do Not Match!",l.disabled=!0):(a.style.visibility="hidden",a.innerHTML="",l.disabled=!1)}),u.oninput=(({target:e})=>{check_passwords(e)}),u.onkeydown=(e=>{13!==e.keyCode||l.disabled||l.click()}),c.oninput=(()=>{u.value.length>0&&check_passwords(u)}),d.oninput=(({target:e})=>{a.style.visibility="hidden",a.innerHTML="",function(e){const n=e.value;n.isValid()?n.length<4?(a.style.visibility="visible",a.innerHTML="Username Too Short",c.disabled=!0,u.disabled=!0):n.length>30?(a.style.visibility="visible",a.innerHTML="Username Too Long",c.disabled=!0,u.disabled=!0):(c.disabled=!1,u.disabled=!1):(a.style.visibility="visible",a.innerHTML="Invalid Characters!",c.disabled=!0,u.disabled=!0)}(e)});const y=s("login"),g=s("signup");y.onclick=(()=>{login.style.backgroundColor="#6200ee",login.style.color="#fff",g.style.backgroundColor="#fff",g.style.color="#6200ee",s("lfbox").style.display="block",s("rfbox").style.display="none"}),g.onclick=(()=>{g.style.backgroundColor="#6200ee",g.style.color="#fff",y.style.backgroundColor="#fff",y.style.color="#6200ee",s("rfbox").style.display="block",s("lfbox").style.display="none"})})();