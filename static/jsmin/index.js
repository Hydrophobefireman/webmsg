(()=>{const e={fields_empty_or_session_error:"Check Your Username and Password or try to reload the page",no_such_user:"No Such User Exists",incorrect_password:"incorrect password"},n={fields_empty_or_session_error:"Check Your Username and Password or try to reload the page",bad_request:"Bad Username or Password",username_taken:"Username Already Taken"},r=e=>document.getElementById(e),s=r("errors-and-errsAndNotices");String.prototype.isValid=function(){if(this.length>0)return/^[0-9a-zA-Z_.-]+$/.test(this)};const o=e=>`${Object.keys(e).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(e[n])}`).join("&")}`,t=document.querySelector('meta[name="integrity"]').content,a=r("errors"),i=r("login-btn"),l=r("register-btn");l.addEventListener("click",async()=>{const e=r("password-reg").value,a=r("password-reg-conf").value;if(e!==a)return s.innerHTML="Passwords Do Not Match!";{s.innerHTML="Loading";const i=await fetch("/register/check/",{credentials:"include",headers:{"content-type":"application/x-www-form-urlencoded"},method:"post",body:o({user:r("username-reg").value,password:e,checkpw:a,integrity:t})});try{const e=await i.json();if(403===i.status){const r=n[e.error];s.innerHTML=r}else 200!==i.status?s.innerHTML="An Error Occured..please reload the page and try again":s.innerHTML="Account Created. Please Login"}catch(e){return console.log(e),s.innerHTML="An Error Occured..please reload the page and try again"}}}),i.addEventListener("click",async()=>{s.innerHTML="Loading";const n=await fetch("/login/check/",{credentials:"include",method:"post",headers:{"content-type":"application/x-www-form-urlencoded"},body:o({user:r("username-log").value,password:r("password-log").value,integrity:t})});try{const r=await n.json();if(403===n.status){const n=e[r.error];s.innerHTML=n}else 200!==n.status?s.innerHTML="An Error Occured..please reload the page and try again":window.location.replace(`/u/${r.user}`)}catch(e){return console.log(e),s.innerHTML="An Error Occured..please reload the page and try again"}}),r("password-log").addEventListener("keydown",e=>{const n=r("password-log"),s=r("username-log");0!==n.value.length&&0!==s.value.length&&13===e.keyCode&&i.click()});const d=r("username-reg"),c=r("password-reg"),u=r("password-reg-conf");check_passwords=(e=>{e.value!==c.value?(a.style.visibility="visible",a.innerHTML="Passwords Do Not Match!",l.disabled=!0):(a.style.visibility="hidden",a.innerHTML="",l.disabled=!1)}),u.oninput=(({target:e})=>{check_passwords(e)}),u.onkeydown=(e=>{13!==e.keyCode||l.disabled||l.click()}),c.oninput=(()=>{u.value.length>0&&check_passwords(u)}),d.oninput=(({target:e})=>{a.style.visibility="hidden",a.innerHTML="",function(e){const n=e.value;n.isValid()?n.length<4?(a.style.visibility="visible",a.innerHTML="Username Too Short",c.disabled=!0,u.disabled=!0):n.length>30?(a.style.visibility="visible",a.innerHTML="Username Too Long",c.disabled=!0,u.disabled=!0):(c.disabled=!1,u.disabled=!1):(a.style.visibility="visible",a.innerHTML="Invalid Characters!",c.disabled=!0,u.disabled=!0)}(e)});const y=r("login"),g=r("signup");y.onclick=(()=>{login.style.backgroundColor="#6200ee",login.style.color="#fff",g.style.backgroundColor="#fff",g.style.color="#6200ee",r("lfbox").style.display="block",r("rfbox").style.display="none"}),g.onclick=(()=>{g.style.backgroundColor="#6200ee",g.style.color="#fff",y.style.backgroundColor="#fff",y.style.color="#6200ee",r("rfbox").style.display="block",r("lfbox").style.display="none"})})();